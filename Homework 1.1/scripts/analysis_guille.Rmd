---
title: "Statistical Data Analysis - Homework 1.1"
author: "Group 5"
date: "11/10/2019"
output:
  html_document: default
  pdf_document: default
---

> We load the libraries

```{r}
library(ggplot2)
library(lubridate)
library(scales)
library(ggpubr)
library(RColorBrewer)
```

> We load the data and give a quick look at the header

```{r}
movies <- get(load("movies.RData"))
data <- head(movies)
```

```{r results = 'asis', echo= FALSE}
range <- 1:8
range <- list(range,range+8,range+16,range+24)
knitr::kable(data[range[[1]]], caption = paste("From column",range[[1]][1],"to column",range[[1]][8]));
knitr::kable(data[range[[2]]], caption = paste("From column",range[[2]][1],"to column",range[[2]][8]));
knitr::kable(data[range[[3]]], caption = paste("From column",range[[3]][1],"to column",range[[3]][8]));
knitr::kable(data[range[[4]]], caption = paste("From column",range[[4]][1],"to column",range[[4]][8]));

```

> Insert the data cleaning code (filling Null values, etc...)

> We create two new variables to study the data.

```{r}
movies$thtr_rel_date <- as.Date(paste0(movies$thtr_rel_year, "-", movies$thtr_rel_month, "-", movies$thtr_rel_day))
movies$thtr_rel_decade <- as.numeric(format(movies$thtr_rel_date,"%Y")) - (as.numeric(format(movies$thtr_rel_date,"%Y")) %% 10)
movies$thtr_rel_decade <- as.factor(movies$thtr_rel_decade)
```

```{r, echo=FALSE}
paste("Insert some MORE code here please.")
```

# SDA Homework 1.1

We chose the "Films" dataset and we are going to answer the following questions that we thought were interesting.

  
### 1. Is there a relationship between the type/genre and score?
### 2. Comparing different scores (critics/audience/imdb)
	* is there any difference on the audience/critics score by genre?
	
### 3. Comparison best picture/oscar wins and score/oscar wins
	* are oscar-awarded films more liked?
	
### 4. What are the trends over the years?
	* Preferred month for releases? number of films by month (over the years? does it affect the score?)
	* Does the genre change over the years?
	* Do older films tend to have higher score/number of votes? if this is true, it could be because only good old films get remembered
	
### 5. Do actors and directors have a higher score once they won? (find the first film and see the tendency, look for sudden change)

------

> Let's answer some questions then 

## 4. What are the trends over the years?
### - Preferred month for releases? number of films by month (over the years? does it affect the score?)

> We start to count the movies per months to see if there is a pattern in all this time in the release months.

```{r}
ggplot(movies, aes(fill = thtr_rel_decade)) + 
  geom_bar(aes(x = thtr_rel_month, (..count..)/sum(..count..))) + 
  theme_minimal() +
  xlab("Month") + 
  ylab("# of Films") +
  ggtitle("Number of Films released per month each decade ") + 
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) + 
  scale_x_continuous(breaks=1:12,labels=c("Jan", "Feb", "Mar", "Apr","May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec")) + 
  scale_y_continuous(labels=scales::percent)
```

> We can see that overall there is a "pattern" of releases in the months of January, June, October and December, so let's take a better look at this data by decade.
> We breakdown the previous graphs grouping the data by decade.

> We show the data by overall amount of movies and proportionally.

```{r}
ggplot(movies, aes(fill = thtr_rel_decade)) +
  geom_bar(aes(x = thtr_rel_month), width = 0.5) +
  facet_wrap(thtr_rel_decade ~ .) +
  #facet_wrap(facets = "thtr_rel_decade", ) +
  theme_minimal() + 
  xlab("Month") +
  ylab("Number of Films") +
  ggtitle("Number of Films released per month each decade w/ breakdown") +
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) + 
  scale_x_discrete(breaks=1:12,labels=c("Jan", "Feb", "Mar", "Apr","May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec"))
```
```{r}
ggplot(movies, aes(fill = thtr_rel_decade)) +
  geom_bar(aes(x = thtr_rel_month, y = (..prop..)), width = 0.5) +
  facet_wrap(thtr_rel_decade ~ .) +
  theme_minimal() +
  xlab("Month") +
  ylab("% of Films") +
  ggtitle("% Amount of Films released per month each decade w/ breakdown ") +
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) +
  scale_x_discrete(breaks=1:12,labels=c("Jan", "Feb", "Mar", "Apr","May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec"))  +
  scale_y_continuous(labels=scales::percent)
```
> Now we can see clearly that since the 70's there has been a trend of two moments in the years to release movies in theaters: in summer (June) and in the winter Holidays (December and January). However, in this last decade, we only see a spike in December.

### - Does the genre change over the years (by decade)?
```{r}
ggplot(movies, aes(fill = thtr_rel_decade)) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..))) + 
  #facet_wrap(thtr_rel_decade ~ ., nrow = 1) +
  theme_minimal() + 
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) +
  scale_y_continuous(labels=scales::percent) +
  coord_flip()
```

```{r}
# All the plots individually:
gen_1970 <- ggplot(movies[movies$thtr_rel_decade==1970,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'tomato') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() +
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

gen_1980 <- ggplot(movies[movies$thtr_rel_decade==1980,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'gold') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() +
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

gen_1990 <- ggplot(movies[movies$thtr_rel_decade==1990,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'limegreen') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() +
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

gen_2000 <- ggplot(movies[movies$thtr_rel_decade==2000,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'skyblue') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() + 
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

gen_2010 <- ggplot(movies[movies$thtr_rel_decade==2010,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'orchid') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() + 
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

# Facewrap of all the plots
ggplot(movies, aes(fill = thtr_rel_decade)) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..))) + 
  # all options & modifiers  
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() + 
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) +
  scale_y_continuous(labels=scales::percent) +
  coord_flip()
```

> We can see an increment over the years in the Documentary Genre, as well as in Mystery and Suspense. 

### - Do older films tend to have higher score/number of votes? if this is true, it could be because only good old films get remembered	
	
> Let's see what is the amount of votes over the years that we have for all the films.

```{r}
ggplot(movies, aes(fill = thtr_rel_date)) +
  geom_smooth(aes(x = thtr_rel_date, y = imdb_num_votes), color = 'tomato') +
  geom_jitter(aes(x = thtr_rel_date, y = imdb_num_votes), color = 'limegreen', alpha = '0.5' ) +
  theme_minimal() +
  xlab("Date") +
  ylab("# of Votes") +
  ggtitle("# of votes rating movies over the years")
```

> Okay so it seems like the number of votes does increase over the years, but does it afect the overall score?

```{r}
ggplot(movies, aes(fill = thtr_rel_date)) +
  geom_smooth(aes(x = thtr_rel_date, y = imdb_rating), color = 'tomato') +
  theme_minimal() +
  xlab("Date") +
  ylab("Rating") +
  ylim (0, 10) +
  ggtitle("Rating of  movies over the years")
```

```{r}
ggplot(movies, aes(fill = thtr_rel_date)) +
  geom_smooth(aes(x = thtr_rel_date, y = imdb_rating), color = 'tomato') +
  theme_minimal() +
  xlab("Date") +
  ylab("Rating") +
  ylim (6, 8) +
  ggtitle("Zoom: rating of  movies over the years")
```

> We can clearly see a decrease in overall score of this movies, but since it's really minimal, it could also be because of random ratings variation.

