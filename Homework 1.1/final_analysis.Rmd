---
title: "final_analysis"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
---


```{r}
library(ggplot2)
library(plyr)
library(lubridate)
library(dplyr)
library(scales)
library(ggpubr)
```

> LOAD DATA

```{r}
movies <- get(load("movies.RData"))
```

```{r}
  #For R: 
#head(movies) 
  #For R Markdown:
# range <- 1:8
# range <- list(range,range+8,range+16,range+24)
# knitr::kable(data[range[[1]]], caption = paste("From column",range[[1]][1],"to column",range[[1]][8]));
# knitr::kable(data[range[[2]]], caption = paste("From column",range[[2]][1],"to column",range[[2]][8]));
# knitr::kable(data[range[[3]]], caption = paste("From column",range[[3]][1],"to column",range[[3]][8]));
# knitr::kable(data[range[[4]]], caption = paste("From column",range[[4]][1],"to column",range[[4]][8]));

```

```{r}
summary(movies)
```

> TRANSFORM DATA

```{r}
#Runtime:
movies[!complete.cases(movies['runtime']),]
movies$runtime[movies$title == "The End of America"] <- 74
#https://www.imdb.com/title/tt1294790/

#Director:
movies$director[movies$title == "Lorenzo's Oil"] <- "George Miller"
#https://es.wikipedia.org/wiki/Lorenzo%27s_Oil_(pel%C3%ADcula)
movies$director[movies$title == "The Ninth Gate"] <- "Roman Polanski"
#https://es.wikipedia.org/wiki/The_Ninth_Gate

#Studio:
movies$studio <- as.character(movies$studio)
movies$studio[movies$title == "Oliver & Company"] <-
  "Walt Disney Pictures"
#https://es.wikipedia.org/wiki/Oliver_y_su_pandilla
movies$studio[movies$title == "Attack of the 50 Foot Woman"] <-
  "Woolner Brothers Pictures Inc."
#https://www.imdb.com/title/tt0051380/
movies$studio[movies$title == "Inbred"] <- "Melanie Light"
#https://www.imdb.com/title/tt1723124/fullcredits
movies$studio[movies$title == "Caveman"] <- "United Artists"
#https://es.wikipedia.org/wiki/El_cavern%C3%ADcola
movies$studio[movies$title == "Dirty Sanchez: The Movie"] <-
  "Vertigo Films"
#https://www.rottentomatoes.com/m/dirty_sanchez
movies$studio[movies$title == "The Man Who Sued God"] <-
  "Australian Film Finance Corporation (AFFC), New South Wales Film & Television Office, Showtime Australia See more"
#https://www.imdb.com/title/tt0268437/
movies$studio[movies$title == "Inserts"] <-
  "Film and General Productions"
#https://www.filmaffinity.com/es/film740308.html
movies$studio <- factor(movies$studio)

#DVD realease date
movies[!complete.cases(movies['dvd_rel_year']), ]
movies$dvd_rel_year[movies$title == "Charlie: The Life and Art of Charles Chaplin"] <-
  2003
movies$dvd_rel_month[movies$title == "Charlie: The Life and Art of Charles Chaplin"] <-
  11
movies$dvd_rel_day[movies$title == "Charlie: The Life and Art of Charles Chaplin"] <-
  5
#https://www.imdb.com/title/tt0379730/releaseinfo
movies$dvd_rel_year[movies$title == "The Squeeze"] <- 2015
movies$dvd_rel_month[movies$title == "The Squeeze"] <- 6
movies$dvd_rel_day[movies$title == "The Squeeze"] <- 9
#https://medium.com/@releasebandyal/producer-michael-doven-announces-release-of-the-squeeze-on-dvd-75a982d0a047
movies$dvd_rel_year[movies$title == "Electric Dreams"] <- 1984
#https://en.wikipedia.org/wiki/Electric_Dreams_(film)
movies$dvd_rel_year[movies$title == "The Last Remake of Beau Geste"] <-
  2010
movies$dvd_rel_month[movies$title == "The Last Remake of Beau Geste"] <-
  1
movies$dvd_rel_day[movies$title == "The Last Remake of Beau Geste"] <-
  11
#https://en.wikipedia.org/wiki/The_Last_Remake_of_Beau_Geste

#Actors:
movies[!complete.cases(movies['actor4']), ]
movies$actor4[movies$title == "Attack of the 50 Foot Woman"] <-
  "Roy Gordon"
#https://www.imdb.com/title/tt0051380/fullcredits/?ref_=tt_ov_st_sm

movies[!complete.cases(movies['actor5']), ]
movies$actor5[movies$title == "Attack of the 50 Foot Woman"] <-
  "George Douglas"
#https://www.imdb.com/title/tt0051380/fullcredits/?ref_=tt_ov_st_sm
movies$actor5[movies$title == "The Illusionist (L'illusionniste)"] <-
  "Eleanor Tomlinson"
#https://en.wikipedia.org/wiki/The_Illusionist_(2006_film)

# We found that one movie had won a movie award but it didn't appear as nominated
ggplot(aes(x=best_pic_nom), data=movies[movies$best_pic_win=="yes",]) +
  geom_bar(aes( fill = best_dir_win)) +
  theme_minimal() +
  xlab("") + 
  ylab("Number of samples") +
  scale_fill_discrete("Best picture nominated")

movies[movies$best_pic_nom=="no" & movies$best_pic_win=="yes",]
movies[movies$best_pic_nom=="no" & movies$best_pic_win=="yes",]$best_pic_nom <- "yes"


#Column manipulation
movies$thtr_rel_date <- as.Date(paste0(movies$thtr_rel_year, "-", movies$thtr_rel_month, "-", movies$thtr_rel_day))
movies$dvd_rel_date <- as.Date(paste0(movies$dvd_rel_year, "-", movies$dvd_rel_month, "-", movies$dvd_rel_day))

movies$thtr_rel_decade <- as.numeric(format(movies$thtr_rel_date,"%Y")) - (as.numeric(format(movies$thtr_rel_date,"%Y")) %% 10)
movies$thtr_rel_decade <- as.factor(paste(as.factor(movies$thtr_rel_decade),'s', sep = '\''))

movies$top200_box <- NULL

movies$dvd_rel_day <- NULL
movies$dvd_rel_month <- NULL
movies$dvd_rel_year <- NULL

#movies$thtr_rel_day <- NULL
#movies$thtr_rel_month <- NULL
#movies$thtr_rel_year <- NULL

movies$imdb_url <- NULL
movies$rt_url <- NULL

```

```{r}
head(movies)
```

```{r}
summary(movies)
```


# SDA Homework 1.1

We chose the "Films" dataset and we are going to answer the following questions that we thought were interesting.

  
### 1. Is there a relationship between the type/genre and score?
### 2. Comparing different scores (critics/audience/imdb)

* Is there any difference on the audience/critics score by genre?
* Is there any difference on the audience/critics score by MPAA?
	
### 3. Comparison best picture/oscar wins and score/oscar wins

* Are oscar-awarded films more liked?
	
### 4. What are the trends over the years?

* Preferred month for releases? number of films by month (over the years? does it affect the score?)
* Does the genre change over the years?
* Do older films tend to have higher score/number of votes? if this is true, it could be because only good old films get remembered
	
### 5. Do actors and directors have a higher score once they won? (find the first film and see the tendency, look for sudden change)

------

## 1. Is there a relationship between the type/genre and score?

```{r}
g1_1_1 <- ggplot(data=movies, aes(x=audience_score)) +
  geom_histogram(bins=30, aes(fill = title_type), position = "identity", alpha = 0.7) +
  scale_color_manual(values = c("tomato", "skyblue", "limegreen")) +
  scale_fill_manual(values = c("tomato", "skyblue", "limegreen")) +
  #scale_x_continuous(breaks = 1:100,labels = 1:100) + 
  xlab("Audience Score") +
  ylab("Number of samples") +
  ylim(0,75) +
  theme_minimal() +
  theme(legend.position = "none")

g1_1_2 <- ggplot(data=movies, aes(x=critics_score)) +
  geom_histogram(bins=30, aes(fill = title_type), position = "identity", alpha = 0.7) +
  scale_color_manual(values = c("tomato", "skyblue", "limegreen")) +
  scale_fill_manual(values = c("tomato", "skyblue", "limegreen")) +
  #scale_x_continuous(breaks = 1:100,labels = 1:100) + 
  xlab("Critics Score") +
  ylab("") +
  ylim(0,75) +
  theme_minimal() +
  theme(legend.position = "none")

g1_1_3 <- ggplot(data=movies, aes(x=imdb_rating)) +
  geom_histogram(bins=30, aes(fill = title_type), position = "identity", alpha = 0.7) + 
  scale_color_manual(values = c("tomato", "skyblue", "limegreen")) +
  scale_fill_manual("Title Type",values = c("tomato", "skyblue", "limegreen")) +
  scale_x_continuous(breaks = seq(0,8,2),labels = seq(0,100,25)) + 
  xlab("IMDB Score") +
  ylab("") +
  ylim(0,75) +
  theme_minimal() +
  theme(legend.position = "right")

g1_1 <- ggarrange(
    g1_1_1,
    g1_1_2,
    g1_1_3,
    ncol = 3,
    nrow = 1,
    widths = c(200,200,330)
  ) %>% annotate_figure(top = text_grob("Distribution of Movies for each scoring source", face = "bold"))

g1_1

```

```{r}
g1_2_1 <- ggplot(data=movies, aes(x=audience_score)) +
  geom_density(aes(fill = title_type), kernel = "gaussian", alpha = 0.3)+
  scale_fill_manual("Title Type",values = c("tomato", "skyblue", "limegreen")) + 
  xlab("Audience Score") +
  ylab("Density") +
  xlim(0,100) +
  ylim(0,0.11) +
  theme_minimal() +
  theme(legend.position = "none")

g1_2_2 <- ggplot(data=movies, aes(x=critics_score)) +
  geom_density(aes(fill = title_type), kernel = "gaussian", alpha = 0.3)+
  scale_fill_manual("Title Type",values = c("tomato", "skyblue", "limegreen")) + 
  #scale_y_continuous(seq(0,1,0.1)) +
  xlab("Critics Score") +
  ylab("") +
  xlim(0,100) +
  ylim(0,0.11) +
  theme_minimal() +
  theme(legend.position = "none")

g1_2_3 <- ggplot(data=movies, aes(x=imdb_rating*10)) +
  geom_density(aes(fill = title_type), kernel = "gaussian", alpha = 0.3)+
  scale_fill_manual("Title Type",values = c("tomato", "skyblue", "limegreen")) + 
  #scale_y_continuous(seq(0,1,0.1)) +
  xlab("IMDB Score") +
  ylab("") +
  xlim(0,100) +
  ylim(0,0.11) +
  theme_minimal() +
  theme(legend.position = "right")

g1_2 <- ggarrange(
    g1_2_1,
    g1_2_2,
    g1_2_3,
    ncol = 3,
    nrow = 1,
    widths = c(200,200,330)
  ) %>% annotate_figure( top = text_grob("Distribution of Movies for each scoring source", face = "bold"))

g1_2

```


```{r}
g1_3_1 <- ggplot(data=movies, aes(x = reorder(genre, audience_score, median, order=TRUE), y = audience_score, group = genre, fill = genre)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") +
  xlab("Genre") +
  #xlim(0,100) +
  ylab("Audience Score") +
  theme_minimal() +
  coord_flip()

g1_3_2 <- ggplot(data=movies, aes(x = reorder(genre, audience_score, median, order=TRUE), y = critics_score, group = genre, fill = genre)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") +
  xlab(" ") +
  #xlim(0,100) +
  ylab("Critics Score") +
  theme_minimal() +
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
  coord_flip()

g1_3_3 <- ggplot(data=movies, aes(x = reorder(genre, audience_score, median, order=TRUE), y = imdb_rating*10, group = genre, fill = genre)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") +
  xlab(" ") +
  #xlim(0,100) +
  ylab("IMDB Rating") +
  theme_minimal() +
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
  coord_flip()

g1_3 <- ggarrange(
    g1_3_1,
    g1_3_2,
    g1_3_3,
    ncol = 3,
    nrow = 1,
    widths = c(300,200,200)
  ) %>% annotate_figure( top = text_grob("Genre rating of Movies for each scoring source", face = "bold"))

g1_3
```



## 2. Comparing different scores (critics/audience/imdb)
### - Is there any difference on the audience/critics score by genre?
### - Is there any difference on the audience/critics score by MPAA score?

```{r}
score = list();

score$genre_score_agg = list(
  "critics" = aggregate(critics_score ~ genre , movies, mean),
  "audience" = aggregate(audience_score ~ genre, movies, mean),
  "imdb" = aggregate(imdb_rating ~ genre, movies, mean)
)


score$genre_metrics_grid = expand.grid(year =sort(unique(movies$genre)),
                                       metrics = c("Critic", "Audience", "IMDB"))

score$genre_metrics_grid$genre_score_agg =c(score$genre_score_agg$critics$critics_score,
                                            score$genre_score_agg$audience$audience_score, 
                                            score$genre_score_agg$imdb$imdb_rating)

score$genre_metrics_grid$genre_score_agg_rescaled = 
  c(
    rescale(score$genre_score_agg$critics$critics_score, from=(c(1,100))), 
    rescale(score$genre_score_agg$audience$audience_score, from=(c(1,100))), 
    rescale(score$genre_score_agg$imdb$imdb_rating, from=(c(1,10))))

g2_1.1 <- ggplot(score$genre_metrics_grid)+
  geom_tile(aes(x=metrics, y=year,fill=genre_score_agg_rescaled))+
  scale_fill_distiller( limits=c(0,1), palette = "PuOr") +
  labs(title = "Comparision of scores across genres (Heatmap)", face = "bold", x = "", y="", fill="")+
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

g2_1.1
```

To compare the three different score types: Critic, Audience and IMDB to be comaral they must be rescaled as while Critic and Audience are of the range 1-100, IMDB is 1-10. After rescaling, to the range 0-1, a visual comparison of the different groups can be seen by arranging them on a heatmap. 

The most striking feature is the lack of high scores for most genres, except for Documentary and Musical & Performing Arts. From the three groups Critics seem to be the most negative in their scoring, while Audience and IMDB to be more aligned. This clearly seen in Action & Adventure genre where Critics have a far lower score than the other two groups. This may be due to Critics having a different criteria on what constitutes a "good" movie but without details on the required metrics this is only speculation. Conversely though IMBD scores are most unaligned with the other groups for the two highest scoring genres, the reasoning for this can not be determined from the data available.

```{r}
mean_score <-
  data.frame(
    "Score" = c(
      mean(movies$imdb_rating)*10,
      mean(movies$audience_score),
      mean(movies$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_all <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) +
  xlim(0, 88) +
  theme(legend.position = "none",axis.title.x = element_blank(), axis.text.y = element_blank()) +
  ggtitle("All genres")

#Action and adventure
action_adventure <- subset(movies, genre == "Action & Adventure")
mean_score <-
  data.frame(
    "Score" = c(
      mean(action_adventure$imdb_rating)*10,
      mean(action_adventure$audience_score),
      mean(action_adventure$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_action <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) +
  xlim(0, 88) +
  theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_blank(),axis.text.y = element_blank()) +
  ggtitle("Action & Adventure")

#Animation
animation <- subset(movies, genre == "Animation")
mean_score <-
  data.frame(
    "Score" = c(
      mean(animation$imdb_rating)*10,
      mean(animation$audience_score),
      mean(animation$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_animation <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("Animation")

#Art House & International
art_house <- subset(movies, genre == "Art House & International")

mean_score <-
  data.frame(
    "Score" = c(
      mean(art_house$imdb_rating)*10,
      mean(art_house$audience_score),
      mean(art_house$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_art_house <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.x = element_blank(),axis.text.y = element_blank()) + ggtitle("Art House & International")

#Comedy
comedy <- subset(movies, genre == "Comedy")

mean_score <-
  data.frame(
    "Score" = c(
      mean(comedy$imdb_rating)*10,
      mean(comedy$audience_score),
      mean(comedy$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )
plot_comedy <-ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("Comedy")

#Documentary
documentary <- subset(movies, genre == "Documentary")

mean_score <-
  data.frame(
    "Score" = c(
      mean(documentary$imdb_rating)*10,
      mean(documentary$audience_score),
      mean(documentary$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_documentary <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("Documentary")

#Drama
drama <- subset(movies, genre == "Drama")

mean_score <-
  data.frame(
    "Score" = c(
      mean(drama$imdb_rating)*10,
      mean(drama$audience_score),
      mean(drama$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_drama <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.x = element_blank(),axis.text.y = element_blank()) + ggtitle("Drama")

#Horror
horror <- subset(movies, genre == "Horror")

mean_score <-
  data.frame(
    "Score" = c(
      mean(horror$imdb_rating)*10,
      mean(horror$audience_score),
      mean(horror$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_horror <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("Horror")

#Musical & Performing Arts
musical <- subset(movies, genre == "Musical & Performing Arts")

mean_score <-
  data.frame(
    "Score" = c(
      mean(musical$imdb_rating)*10,
      mean(musical$audience_score),
      mean(musical$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_musical <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.text.y = element_blank()) + ggtitle("Musical & Performing Arts")

#Mystery & Suspense
mistery <- subset(movies, genre == "Mystery & Suspense")
mean_score <-
  data.frame(
    "Score" = c(
      mean(mistery$imdb_rating)*10,
      mean(mistery$audience_score),
      mean(mistery$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_mistery <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("Mystery & Suspense")

#Other
other <- subset(movies, genre == "Other")

mean_score <-
  data.frame(
    "Score" = c(
      mean(other$imdb_rating)*10,
      mean(other$audience_score),
      mean(other$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )
plot_other <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("Other")

#Science Fiction & Fantasy
science <- subset(movies, genre == "Science Fiction & Fantasy")

mean_score <-
  data.frame(
    "Score" = c(
      mean(science$imdb_rating)*10,
      mean(science$audience_score),
      mean(science$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )
plot_science <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0, 88) + theme(legend.position = "none",axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("Science Fiction & Fantasy")

#Combine the plots...
plot_combined_genre <-ggarrange(
    plot_all,
    plot_action,
    plot_animation,
    plot_art_house,
    plot_comedy,
    plot_documentary,
    plot_drama,
    plot_horror,
    plot_mistery,
    plot_musical,
    plot_other,
    plot_science,
    ncol = 3,
    nrow = 4,common.legend = TRUE, legend="bottom")+
  labs(title = "Comparision of scores across genres (Lollipop chart)", x = "", y="", fill="")+
  theme(plot.title = element_text(hjust = 0.5))

g2_1.2 <-plot_combined_genre
g2_1.2
```

Taking a look at the different lollipop charts, we can see different things:

* Audience gives a higher score than Critics in 10/11 genres (90.9%). The only exception is the Documentary genre.
* IMDB gives a higher score than Critics in 9/11 genres (81.8%). The only exception is the Documentary and Musical & Performance genres.
* IMDB gives a higher score than Audience in 7/11 genres (63.6%).
* Genres like Documentary and Other receive similar ratings from all IMDB, Critics and Audience, whereas in genres like Comedy or Action & Adventure the ratings differ more.

Taking this into account, we can say that the pattern observed in previously is maintained in the individual genres. Critics give the lowest ratings for almost all genres and IMDB and Audience alternate in giving the highest score. There is a difference in the ratings of the different sources according to the genre and this difference follows a pattern, which is more accentuated in some genres than in others.

```{r}
mean_score <-
  data.frame(
    "Score" = c(
      mean(movies$imdb_rating)*10,
      mean(movies$audience_score),
      mean(movies$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_mpaa_all <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0,84) + theme(legend.position = "none",axis.title.x = element_blank(), axis.text.y = element_blank()) + ggtitle("All MPAA ratings")

#G
g <- subset(movies, mpaa_rating == "G")
mean_score <-
  data.frame(
    "Score" = c(
      mean(g$imdb_rating)*10,
      mean(g$audience_score),
      mean(g$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_g <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0,84) + theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("G")

#NC-17
nc_17 <- subset(movies, mpaa_rating == "NC-17")
mean_score <-
  data.frame(
    "Score" = c(
      mean(nc_17$imdb_rating)*10,
      mean(nc_17$audience_score),
      mean(nc_17$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_nc_17 <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0,84) + theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("NC-17")

#PG
pg <- subset(movies, mpaa_rating == "PG")

mean_score <-
  data.frame(
    "Score" = c(
      mean(pg$imdb_rating)*10,
      mean(pg$audience_score),
      mean(pg$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_pg <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0,84) + theme(legend.position = "none",axis.title.x = element_blank(),axis.text.y = element_blank()) + ggtitle("PG")

#PG-13
pg_13 <- subset(movies, mpaa_rating == "PG-13")

mean_score <-
  data.frame(
    "Score" = c(
      mean(pg_13$imdb_rating)*10,
      mean(pg_13$audience_score),
      mean(pg_13$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )
plot_pg_13 <-ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0,84) + theme(legend.position = "none",axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("PG-13")

#R
r <- subset(movies, mpaa_rating == "R")

mean_score <-
  data.frame(
    "Score" = c(
      mean(r$imdb_rating)*10,
      mean(r$audience_score),
      mean(r$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_r <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0,84) + theme(legend.position = "none",axis.title.y = element_blank(),axis.text.y = element_blank()) + ggtitle("R")

#Unrated
unrated <- subset(movies, mpaa_rating == "Unrated")

mean_score <-
  data.frame(
    "Score" = c(
      mean(unrated$imdb_rating)*10,
      mean(unrated$audience_score),
      mean(unrated$critics_score)
    ),
    "Source" = c("IMDB", "Audience", "Critics")
  )

plot_unrated <- ggplot(mean_score, aes(Score, Source)) +
  geom_segment(aes(x = 0, y = Source, xend = Score, yend = Source,colour=Source) ) +  theme_minimal() +
  geom_point(aes(  colour=Source) ) + xlim(0,84) + theme(legend.position = "none",axis.text.y = element_blank()) + ggtitle("Unrated")


#Combine the plots...
plot_combined_mpaa <-ggarrange(
  plot_mpaa_all,
  plot_g,
  plot_nc_17,
  plot_pg,
  plot_pg_13,
  plot_r,
  plot_unrated,
  ncol = 4,
  nrow = 2,common.legend = TRUE, legend="bottom")+
  labs(title = "Comparision of scores across MPAA ratings (Lollipop chart)", x = "", y="", fill="")+
  theme(plot.title = element_text(hjust = 0.5))


g2_2 <-plot_combined_mpaa
g2_2
```

If we now make a similar comparison for the MPAA ratings, we can see the following:

* Audience gives a higher score than Critics in 4/6 MPAA ratings (66.6%). The two MPAA ratings where Critics give a higher score are NC-17 and Unrated.
* IMDB gives a higher score than Critics in 4/6 MPAA ratings (66.6%). Again, the two exceptions are NC-17 and Unrated.
* IMDB tends to give a higher score than Audience. This happens, again, in 4/6 MPAA ratings (66.6%). The MPAA ratings where this does not happen are G and Unrated.
* Exceptuating G and PG, the rest of the MPAA ratings receive clearly different, although not highly, scores from the three different sources.

From these findings we can see that overall IMDB and the Audience tend to give more positive reviews than the Critics. However, the scores given by the three sources are not that different one from the other in the majority of the MPAA ratings (the only exceptions being the extreme Critics score for NC-17 and PG-13). Therefore, there is not enough evidence to say that there is a significant difference in the score according to the MPAA rating.


## 3. Comparison best picture/oscar nominated and score/oscar nominated
### - Are oscar-awarded films more liked?


```{r}
# This is figure 3.1 in the Document
g3_1_1 <- ggplot(data=movies, aes(x = best_pic_nom, y = audience_score, group = best_pic_nom, fill = best_pic_nom)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") +
  theme_minimal() +
  labs(x = "Best picture nomination", y = "Audience score")

g3_1_2 <- ggplot(data=movies, aes(x = best_actor_win, y = audience_score, group = best_actor_win, fill = best_actor_win)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") +
  theme_minimal() +
  labs(x = "Best actor win", y=" ") 

g3_1_3 <- ggplot(data=movies, aes(x = best_actress_win, y = audience_score, group = best_actress_win, fill = best_actress_win)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") +
  theme_minimal()+
  labs(x = "Best actress win", y=" ") 

g3_1_4 <- ggplot(data=movies, aes(x = best_dir_win, y = audience_score, group = best_dir_win, fill = best_dir_win)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") +
  theme_minimal() +
labs(x = "Best director win", y=" ") 

g3_1 <- ggarrange(
    g3_1_1,
    g3_1_2,
    g3_1_3,
    g3_1_4,
    ncol = 4,
    nrow = 1,
    widths = c(200)
  ) %>% annotate_figure(top = text_grob("Score comparison of nominated and awarded movies (box plot)", face = "bold"))

g3_1
```

```{r}
g3_2_1 <- ggplot(data=movies, aes(x = best_pic_nom, y = audience_score, group = best_pic_nom, fill = best_pic_nom)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") +
  theme_minimal()+
  labs(x = "Best picture nomination", y="Audience score")

g3_2_2 <- ggplot(data=movies, aes(x = best_pic_nom, y = critics_score, group = best_pic_nom, fill = best_pic_nom)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") + 
  theme_minimal()+
  labs(x = "Best picture nomination", y="Critics score")

g3_2_3 <- ggplot(data=movies, aes(x = best_pic_nom, y = imdb_rating, group = best_pic_nom, fill = best_pic_nom)) +
  geom_boxplot(alpha = .7) +
  geom_jitter(width = .05, alpha = .4) +
  guides(fill = "none") + 
  theme_minimal()+
  labs(x = "Best picture nomination", y="IMDB rating")

g3_2 <- ggarrange(
    g3_2_1,
    g3_2_2,
    g3_2_3,
    ncol = 3,
    nrow = 1
  ) %>% annotate_figure(top = text_grob("Score comparison of nominated and awarded movies by different critics (box plot)", face = "bold"))

g3_2
```


```{r}
g3_3_1 <- ggplot(aes(x=best_actor_win), data=movies[movies$best_pic_nom=="yes",]) +
  geom_bar(aes( fill = best_dir_win), show.legend = FALSE) +
  theme_minimal() +
  xlab("Has the actor been awarded?") + 
  ylab("Number of samples") +
  scale_fill_discrete("Best actor")

g3_3_2 <- ggplot(aes(x=best_actress_win), data=movies[movies$best_pic_nom=="yes",]) +
  geom_bar(aes( fill = best_dir_win), show.legend = FALSE) +
  theme_minimal() +
  xlab("Has the actress been awarded?") + 
  ylab(" ") +
  scale_fill_discrete("Best actress")

g3_3_3 <- ggplot(aes(x=best_dir_win), data=movies[movies$best_pic_nom=="yes",]) +
  geom_bar(aes( fill = best_dir_win)) +
  theme_minimal() +
  xlab("Has the director been awarded") + 
  ylab(" ") +
  scale_fill_discrete("Best director")

g3_3 <- ggarrange(
    g3_3_1,
    g3_3_2,
    g3_3_3,
    ncol = 3,
    nrow = 1,
    widths = c(200,200,300),
    labels = c("1", "2", "3","4")
  ) %>% annotate_figure(top = text_grob("Relationship between awarded cast members and awarded directors", face = "bold"))

g3_3
```

```{r}
 best_pic_movies <- subset(movies, c(best_pic_win == "yes"))

 #Add a column showing if they have won another award
 best_pic_movies$other_win <- NA

 if (best_pic_movies$best_actor_win == "yes" ||
     best_pic_movies$best_actress_win == "yes" ||
     best_pic_movies$best_dir_win == "yes") {
   best_pic_movies$other_win <- "yes"
 } else{
    best_pic_movies$other_win <- "no"
 }

 #Plots...
 #Best movies that have won another award
 best_movie_another_award <- plyr::count(best_pic_movies$other_win)
 best_movie_another_award <- best_movie_another_award %>%
   arrange((freq)) %>%
   mutate(lab.ypos = cumsum(freq) - 0.5 * freq)

 pie_another_award <-
   ggplot(best_movie_another_award, aes(x = "", y = freq, fill = x)) +
   geom_bar(width = 1,
            stat = "identity",
            color = "white") +
   coord_polar("y", start = 0) +
   theme_void() +
   geom_text(aes(label = signif((freq / 7) * 100), digits = 2),
             position = position_stack(vjust = 0.5),
             color = "white") +
   labs(fill = "Another award") +
   ggtitle("Best movies w/ awarded member") +
   theme(plot.title = element_text(size = 12, hjust = 0.5)) +
   scale_fill_manual(values = "#00BFC4")

 #Best movies that have won best actor award
 best_movie_best_actor <- plyr::count(best_pic_movies$best_actor_win)
 best_movie_best_actor <- best_movie_best_actor %>%
   arrange((freq)) %>%
   mutate(lab.ypos = cumsum(freq) - 0.5 * freq)

 pie_best_actor <-
   ggplot(best_movie_best_actor, aes(x = "", y = freq, fill = x)) +
   geom_bar(width = 1,
            stat = "identity",
            color = "white") +
   coord_polar("y", start = 0) +
   theme_void() +
   geom_text(aes(label = signif((freq / 7) * 100), digits = 2),
             position = position_stack(vjust = 0.5),
             color = "white") +
   labs(fill = "Best actor") +
   ggtitle("Best movies w/ best actor") +
   theme(plot.title = element_text(size = 12, hjust = 0.5))

 #Best movies that have won best actress award
 best_movie_best_actress <- plyr::count(best_pic_movies$best_actress_win)
 best_movie_best_actress <- best_movie_best_actress %>%
   arrange((freq)) %>%
   mutate(lab.ypos = cumsum(freq) - 1 * freq)

 pie_best_actress <-
   ggplot(best_movie_best_actress, aes(x = "", y = freq, fill = x)) +
   geom_bar(width = 1,
            stat = "identity",
            color = "white") +
   coord_polar("y", start = 0) +
   theme_void() +
   geom_text(aes(label = signif((freq / 7) * 100), digits = 2),
             position = position_stack(vjust = 0.5),
             color = "white") +
   labs(fill = "Best actress") +
   ggtitle("Best movies w/ best actress") +
   theme(plot.title = element_text(size = 12, hjust = 0.5))

 #Best movies that have won best director award
 best_movie_best_director <- plyr::count(best_pic_movies$best_dir_win)
 best_movie_best_director <- best_movie_best_director %>%
   arrange((freq)) %>%
   mutate(lab.ypos = cumsum(freq) - 0.9 * freq)

 pie_best_director <-
   ggplot(best_movie_best_director, aes(x = "", y = freq, fill = x)) +
   geom_bar(width = 1,
            stat = "identity",
            color = "white") +
   coord_polar("y", start = 0) +
   theme_void() +
   geom_text(aes(label = signif((freq / 7) * 100), digits = 2),
             position = position_stack(vjust = 0.5),
             color = "white") +
   labs(fill = "Best director") +
   ggtitle("Best movies w/ best director") +
   theme(plot.title = element_text(size = 12, hjust = 0.5))

 #Combine plots!
 plot_combined_awarded <-
   ggarrange(
     pie_another_award,
     pie_best_actor,
    pie_best_actress,
    pie_best_director,
    ncol = 2,
    nrow = 2,
    widths = c(400,400,400,400)
  )+
  labs(title = "Proportion of awards in the best movies (Pie chart)", x = "", y="", fill="")+
  theme(plot.title = element_text(hjust = 0.5))

g3_4 <- plot_combined_awarded
g3_4
```

Looking at the pie charts, we can see that the movies in the dataset that have received the award for best film always have a cast/crew member with another award. It must be taken into account that the actors, actresses and directors could have received their award at any point in their career, not necessarily for the awarded film in which they participate. That is, the pie charts are not meant to show that if a cast/crew member receives an award for one film, that film is more likely to be awarded itself. However, the plots can serve to study the relationship between having high quality professionals working in a movie and that movie receiving an award. 

Considering this, we can see that most awarded movies in this dataset have a director that has or will receive an award. The presence of awarded directors in 6/7 movies highly surpasses the proportion of awarded movies with awarded actors and actresses. This hints that the quality of the director is more influential than that of the actors and actresses in determining if the movie is awarded for best film. This deduction makes sense, since actors are only responsible for playing their roles whereas the director's decisions involve all the elements of a film.

## 4. What are the trends over the years?
###	- Preferred month for releases? number of films by month (over the years?)

> We start to count the movies per months to see if there is a pattern in all this time in the release months.

```{r}
g4_1_1 <- ggplot(movies, aes(fill = thtr_rel_decade)) + 
  geom_bar(aes(x = thtr_rel_month, (..count..)/sum(..count..))) + 
  theme_minimal() +
  xlab("Month") + 
  ylab("Percentage of Movies") +
  ggtitle("Percentage of Movies released per month each decade ") + 
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) + 
  scale_x_continuous(breaks=1:12,labels=c("Jan", "Feb", "Mar", "Apr","May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec")) +
  scale_y_continuous(labels=scales::percent)

g4_1_1
```

> We can see that overall there is a "pattern" of releases in the months of January, June, October and December, so let's take a better look at this data by decade.
> We breakdown the previous graphs grouping the data by decade.

```{r}
g4_1_2 <- ggplot(movies, aes(fill = thtr_rel_decade)) +
  geom_bar(aes(x = thtr_rel_month), width = 0.5, show.legend = FALSE) +
  facet_wrap(thtr_rel_decade ~ ., nrow = 1) +
  #facet_wrap(facets = "thtr_rel_decade", ) +
  theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  xlab("Month") +
  ylab("Number of Movies") +
  ggtitle("Number of Movies released per month each decade with breakdown") +
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) + 
  scale_x_continuous(breaks=1:12,labels=c("Jan", "Feb", "Mar", "Apr","May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec")) 

g4_1_2
```

```{r}
g4_1_3 <-ggplot(movies, aes(fill = thtr_rel_decade)) +
  geom_bar(aes(x = thtr_rel_month, y = (..prop..)), width = 0.5, show.legend = FALSE) +
  facet_wrap(thtr_rel_decade ~ ., nrow = 1) +
  theme_minimal() + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  xlab(" ") +
  ylab("Percentage of Films") +
  ggtitle("Percentage of Films released per month each decade with breakdown ") +
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) +
  scale_x_continuous(breaks=1:12,labels=c("Jan", "Feb", "Mar", "Apr","May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec")) +
  scale_y_continuous(labels=scales::percent)

g4_1_3
```

> Now we can see clearly that since the 70's there has been a trend of two moments in the years to release movies in theaters: in summer (June) and in the winter Holidays (December and January). However, in this last decade, we only see a spike in December.

### - Does the genre change over the years (by decade)?

> We start by plotting the films separated by genre and gruped by decade in color.

```{r}
g4_2_1 <- ggplot(movies, aes(fill = thtr_rel_decade)) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..))) + 
  #facet_wrap(thtr_rel_decade ~ ., nrow = 1) +
  theme_minimal() + 
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) +
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

g4_2_1
```
> Now we will do a breakdown on the graph:

```{r}
# All the plots individually:
g4_2_2 <- ggplot(movies[movies$thtr_rel_decade==1970,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'tomato') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() +
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

g4_2_3 <- ggplot(movies[movies$thtr_rel_decade==1980,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'gold') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() +
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

g4_2_4 <- ggplot(movies[movies$thtr_rel_decade==1990,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'limegreen') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() +
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

g4_2_5 <- ggplot(movies[movies$thtr_rel_decade==2000,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'skyblue') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() + 
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

g4_2_6 <- ggplot(movies[movies$thtr_rel_decade==2010,]) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..)), fill = 'orchid') + 
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() + 
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

# Facewrap of all the plots
g4_2_7.1 <- ggplot(movies, aes(fill = thtr_rel_decade)) +
  geom_bar(aes(x = genre, y = (..count..)/sum(..count..))) + 
  # all options & modifiers  
  facet_wrap(thtr_rel_decade ~ ., nrow = 2) +
  theme_minimal() + 
  xlab("Genres") +
  ylab("% of Films") +
  ggtitle("Genre of Films released each decade w/ breakdown") + 
  scale_fill_discrete(name = "Decade", labels=c("70's","80's","90's","00's","10's")) +
  scale_y_continuous(labels=scales::percent) +
  coord_flip()

# g4_2_7.2 <- ggarrange(
#     g4_2_2,
#     g4_2_3,
#     g4_2_4,
#     g4_2_5,
#     g4_2_6,
#     ncol = 3,
#     nrow = 2
#   ) %>% annotate_figure(top = text_grob("Relationship between awarded cast members and awarded directors", face = "bold"))

g4_2_7.1
```

> We can see an increment over the years in the Documentary Genre, as well as in Mystery and Suspense. 

### - Do older films tend to have higher score/number of votes? if this is true, it could be because only good old films get remembered	
	
> Let's see what is the amount of votes over the years that we have for all the films.

```{r}
g4_3_1 <-  ggplot(movies, aes(fill = thtr_rel_date)) +
  geom_smooth(aes(x = thtr_rel_date, y = imdb_num_votes), color = 'tomato', show.legend = FALSE) +
  geom_jitter(aes(x = thtr_rel_date, y = imdb_num_votes), color = 'limegreen', alpha = '0.5' , show.legend = FALSE) +
  theme_minimal() +
  xlab("Date") +
  ylab("Number of Votes") +
  ggtitle("Number of movie rating vote over the years")

g4_3_1
```

> Okay so it seems like the number of votes does increase over the years, but does it afect the overall score?

```{r}
g4_3_2 <- ggplot(movies, aes(fill = thtr_rel_date)) +
  geom_smooth(aes(x = thtr_rel_date, y = imdb_rating), color = 'tomato', show.legend = FALSE) +
  theme_minimal() +
  xlab("Date") +
  ylab("Rating") +
  ylim (0, 10) +
  ggtitle("Rating of movies over the years")

g4_3 <- ggarrange(g4_3_1, g4_3_2)
g4_3
```
> Let's zoom to see if we can see more clearly if there is some change

```{r}
g4_3_2.2 <- ggplot(movies, aes(fill = thtr_rel_date)) +
  geom_smooth(aes(x = thtr_rel_date, y = imdb_rating), color = 'tomato') +
  theme_minimal() +
  xlab("Date") +
  ylab("Rating") +
  #ylim (6.5, 7.5) +
  ggtitle("Zoom: rating of  movies over the years")
```

> We can clearly see a decrease in overall score of this movies, but since it's really minimal, it could also be because of random ratings variation.


```{r}
ggplot(data=movies, aes(x=thtr_rel_date, y=audience_score)) + geom_point(aes(col=best_pic_nom), size=3)

commonTheme = list(labs(color="Density",fill="Density", x="Date", y="Overall score"))
ggplot(data=movies,aes(thtr_rel_date, audience_score)) + 
  stat_density2d(aes(fill=..level..,alpha=..level..),geom='polygon',colour='black') + 
  scale_fill_continuous(low="green",high="red") +
  guides(alpha="none") +
  theme_minimal() +
  commonTheme
```


```{r}
commonTheme = list(labs(color="Density",fill="Density", x="Runtime", y="Overall score"))
ggplot(data=movies,aes(runtime, audience_score)) + 
  stat_density2d(aes(fill=..level..,alpha=..level..),geom='polygon',colour='black') + 
  scale_fill_continuous(low="green",high="red") +
  guides(alpha="none") + 
  theme_minimal() +
   commonTheme
```


## 5. Do actors and directors have a higher score once they won? (find the first film and see the tendency, look for sudden change)


```{r}
best_dirs =  subset(movies, movies$best_dir_win == "yes") %>%
  group_by(director) %>%
  filter(n() > 2)

win_years = data.frame(
  year = c(2010, 2007,1987, 1990, 1978),
  director=c("Kathryn Bigelow", "Martin Scorsese","Oliver Stone","Oliver Stone","Woody Allen")
)

win_year_intersects = 
  geom_vline(data = win_years, aes(xintercept=year, color = director), show.legend = FALSE)

p1 = ggplot(best_dirs, aes(y=critics_score, x=thtr_rel_year, color=director))+
  geom_point()+
  geom_line(show.legend = FALSE) +
  labs(title = "Oscar winning director movie scores", y = "Critics Score", x = "", color="Movie Released")+ theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+
  ylim(1,100)+
  win_year_intersects

p2 = ggplot(best_dirs, aes(y=audience_score, x=thtr_rel_year, color=director),limits = c(1,100))+
  geom_point()+
  geom_line() +
  labs(y = "Audience Score", x = "")+ theme_minimal() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+
  ylim(1,100)+
  win_year_intersects

p3= ggplot(best_dirs, aes(y=imdb_rating, x=thtr_rel_year, color=director))+ theme_minimal() +
  geom_point()+
  geom_line() +
  labs(y = "IMDB Rating", x = "Film Release Year")+ 
  ylim(1,10)+
  win_year_intersects

ggarrange(p1, p2, p3, nrow = 3, common.legend = TRUE, legend="bottom")

```

To answer this question we visualized if the likelyhood of winning a director Oscar could be predicted by the tread of a director review scores. It was decided to only include those that had directed more than two movies to be able to properly chart their successes over the years. By plotting each director's movie releases (points) against the three differnt score categories we can see that most have a aarying level of succsess over the years  It can be seen the comparisons between the three groups vary but they approximately show the same trajectory for the directors over the years. It should be noted that in all three scoring categories only U-Turn releasede in 1997 and directed by Oliver Stone, scored less than half the available points. It can be shown then that, based on the available data, that directors win win Oscars have high scoring films.

To see if these trends indcated likelyhood of winning an Oscar the years each director has won the best direct awrd were added to the plot using vertical lines. Unfortuanly due to the lack of data available in the dataset it is not possible to confidently determine any information. It could be speculated that a ariectors highest scoringmovie will win them an Oscar by looking at the data for Kathryn Bigelow and Woodly Allen. But as the movies won by Martin Scorses and Oliver Stone are not present in the dataset it is not possible to see the score trends at these times in their careers. Thus we are not able to answer the puestion we proposed. To be able to give a concrete answer for this question a larger dataset will be required. This idealy would not only include missing movies for the directors shown but for those removed for having insufficent having entries records.




