setwd("~/SDA/SDA_HW_2019/Homework 1.1")
install.packages(c("dplyr", "ggplot2", "ggpubr", "gridExtra", "lubridate", "plyr", "scales"))
library(ggplot2)
library(ggpubr)
installed.packages(ggpubr)
installed.packages("ggpubr")
library(ggplot2)
library(ggpubr)
library(plyr)
library(lubridate)
library(ggplot2)
library(ggpubr)
library(ggplot2)
#library(ggpubr)
library(plyr)
library(lubridate)
library(dplyr)
library(scales)
library(gridExtra)
library(ggplot2)
#library(ggpubr)
library(plyr)
library(lubridate)
library(dplyr)
library(scales)
library(gridExtra)
movies <- get(load("movies.RData"))
#For R:
#head(movies)
#For R Markdown:
# range <- 1:8
# range <- list(range,range+8,range+16,range+24)
# knitr::kable(data[range[[1]]], caption = paste("From column",range[[1]][1],"to column",range[[1]][8]));
# knitr::kable(data[range[[2]]], caption = paste("From column",range[[2]][1],"to column",range[[2]][8]));
# knitr::kable(data[range[[3]]], caption = paste("From column",range[[3]][1],"to column",range[[3]][8]));
# knitr::kable(data[range[[4]]], caption = paste("From column",range[[4]][1],"to column",range[[4]][8]));
summary(movies)
#Runtime:
movies[!complete.cases(movies['runtime']),]
movies$runtime[movies$title == "The End of America"] <- 74
#https://www.imdb.com/title/tt1294790/
#Director:
movies$director[movies$title == "Lorenzo's Oil"] <- "George Miller"
#https://es.wikipedia.org/wiki/Lorenzo%27s_Oil_(pel%C3%ADcula)
movies$director[movies$title == "The Ninth Gate"] <- "Roman Polanski"
#https://es.wikipedia.org/wiki/The_Ninth_Gate
#Studio:
movies$studio <- as.character(movies$studio)
movies$studio[movies$title == "Oliver & Company"] <-
"Walt Disney Pictures"
#https://es.wikipedia.org/wiki/Oliver_y_su_pandilla
movies$studio[movies$title == "Attack of the 50 Foot Woman"] <-
"Woolner Brothers Pictures Inc."
#https://www.imdb.com/title/tt0051380/
movies$studio[movies$title == "Inbred"] <- "Melanie Light"
#https://www.imdb.com/title/tt1723124/fullcredits
movies$studio[movies$title == "Caveman"] <- "United Artists"
#https://es.wikipedia.org/wiki/El_cavern%C3%ADcola
movies$studio[movies$title == "Dirty Sanchez: The Movie"] <-
"Vertigo Films"
#https://www.rottentomatoes.com/m/dirty_sanchez
movies$studio[movies$title == "The Man Who Sued God"] <-
"Australian Film Finance Corporation (AFFC), New South Wales Film & Television Office, Showtime Australia See more"
#https://www.imdb.com/title/tt0268437/
movies$studio[movies$title == "Inserts"] <-
"Film and General Productions"
#https://www.filmaffinity.com/es/film740308.html
movies$studio <- factor(movies$studio)
#DVD realease date
movies[!complete.cases(movies['dvd_rel_year']), ]
movies$dvd_rel_year[movies$title == "Charlie: The Life and Art of Charles Chaplin"] <-
2003
movies$dvd_rel_month[movies$title == "Charlie: The Life and Art of Charles Chaplin"] <-
11
movies$dvd_rel_day[movies$title == "Charlie: The Life and Art of Charles Chaplin"] <-
5
#https://www.imdb.com/title/tt0379730/releaseinfo
movies$dvd_rel_year[movies$title == "The Squeeze"] <- 2015
movies$dvd_rel_month[movies$title == "The Squeeze"] <- 6
movies$dvd_rel_day[movies$title == "The Squeeze"] <- 9
#https://medium.com/@releasebandyal/producer-michael-doven-announces-release-of-the-squeeze-on-dvd-75a982d0a047
movies$dvd_rel_year[movies$title == "Electric Dreams"] <- 1984
#https://en.wikipedia.org/wiki/Electric_Dreams_(film)
movies$dvd_rel_year[movies$title == "The Last Remake of Beau Geste"] <-
2010
movies$dvd_rel_month[movies$title == "The Last Remake of Beau Geste"] <-
1
movies$dvd_rel_day[movies$title == "The Last Remake of Beau Geste"] <-
11
#https://en.wikipedia.org/wiki/The_Last_Remake_of_Beau_Geste
#Actors:
movies[!complete.cases(movies['actor4']), ]
movies$actor4[movies$title == "Attack of the 50 Foot Woman"] <-
"Roy Gordon"
#https://www.imdb.com/title/tt0051380/fullcredits/?ref_=tt_ov_st_sm
movies[!complete.cases(movies['actor5']), ]
movies$actor5[movies$title == "Attack of the 50 Foot Woman"] <-
"George Douglas"
#https://www.imdb.com/title/tt0051380/fullcredits/?ref_=tt_ov_st_sm
movies$actor5[movies$title == "The Illusionist (L'illusionniste)"] <-
"Eleanor Tomlinson"
#https://en.wikipedia.org/wiki/The_Illusionist_(2006_film)
# We found that one movie had won a movie award but it didn't appear as nominated
ggplot(aes(x=best_pic_nom), data=movies[movies$best_pic_win=="yes",]) +
geom_bar(aes( fill = best_dir_win)) +
theme_minimal() +
xlab("") +
ylab("Number of samples") +
scale_fill_discrete("Best picture nominated")
movies[movies$best_pic_nom=="no" & movies$best_pic_win=="yes",]
movies[movies$best_pic_nom=="no" & movies$best_pic_win=="yes",]$best_pic_nom <- "yes"
#Column manipulation
movies$thtr_rel_date <- as.Date(paste0(movies$thtr_rel_year, "-", movies$thtr_rel_month, "-", movies$thtr_rel_day))
movies$dvd_rel_date <- as.Date(paste0(movies$dvd_rel_year, "-", movies$dvd_rel_month, "-", movies$dvd_rel_day))
movies$thtr_rel_decade <- as.numeric(format(movies$thtr_rel_date,"%Y")) - (as.numeric(format(movies$thtr_rel_date,"%Y")) %% 10)
movies$thtr_rel_decade <- as.factor(paste(as.factor(movies$thtr_rel_decade),'s', sep = '\''))
movies$top200_box <- NULL
movies$dvd_rel_day <- NULL
movies$dvd_rel_month <- NULL
movies$dvd_rel_year <- NULL
#movies$thtr_rel_day <- NULL
#movies$thtr_rel_month <- NULL
#movies$thtr_rel_year <- NULL
movies$imdb_url <- NULL
movies$rt_url <- NULL
head(movies)
summary(movies)
g1_1_1 <- ggplot(data=movies, aes(x=audience_score)) +
geom_histogram(bins=30, aes(fill = title_type), position = "identity", alpha = 0.7) +
scale_color_manual(values = c("tomato", "skyblue", "limegreen")) +
scale_fill_manual(values = c("tomato", "skyblue", "limegreen")) +
#scale_x_continuous(breaks = 1:100,labels = 1:100) +
xlab("Audience Score") +
ylab("Number of samples") +
ylim(0,75) +
theme_minimal() +
theme(legend.position = "none")
g1_1_2 <- ggplot(data=movies, aes(x=critics_score)) +
geom_histogram(bins=30, aes(fill = title_type), position = "identity", alpha = 0.7) +
scale_color_manual(values = c("tomato", "skyblue", "limegreen")) +
scale_fill_manual(values = c("tomato", "skyblue", "limegreen")) +
#scale_x_continuous(breaks = 1:100,labels = 1:100) +
xlab("Critics Score") +
ylab("") +
ylim(0,75) +
theme_minimal() +
theme(legend.position = "none")
g1_1_3 <- ggplot(data=movies, aes(x=imdb_rating)) +
geom_histogram(bins=30, aes(fill = title_type), position = "identity", alpha = 0.7) +
scale_color_manual(values = c("tomato", "skyblue", "limegreen")) +
scale_fill_manual("Title Type",values = c("tomato", "skyblue", "limegreen")) +
scale_x_continuous(breaks = seq(0,8,2),labels = seq(0,100,25)) +
xlab("IMDB Score") +
ylab("") +
ylim(0,75) +
theme_minimal() +
theme(legend.position = "right")
g1_1 <- ggarrange(
g1_1_1,
g1_1_2,
g1_1_3,
ncol = 3,
nrow = 1,
widths = c(200,200,330)
) %>% annotate_figure(top = text_grob("Distribution of Movies for each scoring source", face = "bold"))
library(ggplot2)
library(plyr)
library(lubridate)
library(dplyr)
library(scales)
library(ggpubr)
install.packages("ggpubr")
clear
library(ggplot2)
library(plyr)
library(lubridate)
library(dplyr)
library(scales)
library(ggpubr)
install.packages("ggpubr")
install.packages("cowplot")
install.packages("ggpubr")
